# 国际化 (i18n) 设计方案

## 概述

为 Owork 桌面应用实现中英文双语支持，默认中文。

## 需求

- **翻译范围**：全部界面，包括导航、页面标题、按钮、表单、表格、弹窗、状态提示等
- **保留英文的专业术语**：Agent, Skill, MCP, Plugin, Token, Model 名称
- **语言切换**：在 Settings 页面提供语言选项
- **默认语言**：中文 (zh)
- **支持语言**：中文 (zh)、英文 (en)

## 技术方案

### 依赖

```bash
npm install i18next react-i18next
```

### 目录结构

```
desktop/src/
├── i18n/
│   ├── index.ts              # i18next 初始化配置
│   └── locales/
│       ├── zh.json           # 中文翻译
│       └── en.json           # 英文翻译
```

### i18next 配置

```typescript
// src/i18n/index.ts
import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';
import zh from './locales/zh.json';
import en from './locales/en.json';

const savedLanguage = localStorage.getItem('language') || 'zh';

i18n.use(initReactI18next).init({
  resources: {
    zh: { translation: zh },
    en: { translation: en },
  },
  lng: savedLanguage,
  fallbackLng: 'zh',
  interpolation: {
    escapeValue: false,
  },
});

export default i18n;
```

### 入口集成

```typescript
// src/main.tsx
import './i18n';  // 在 App 之前导入
```

### 组件使用

```tsx
import { useTranslation } from 'react-i18next';

function MyComponent() {
  const { t } = useTranslation();
  return <h1>{t('page.title')}</h1>;
}
```

### 语言切换

```typescript
const { i18n } = useTranslation();

const changeLanguage = (lang: 'zh' | 'en') => {
  i18n.changeLanguage(lang);
  localStorage.setItem('language', lang);
};
```

## 翻译 Key 命名规范

```
{namespace}.{feature}.{element}

示例：
common.button.save          → 保存
common.button.cancel        → 取消
agents.page.title           → Agent 管理
agents.page.description     → 创建、配置和监控你的 AI Agent
agents.table.columnName     → 名称
agents.modal.createTitle    → 创建新 Agent
```

## 翻译内容分类

| 类别 | 示例 |
|------|------|
| 导航标签 | Chat → 对话, Settings → 设置 |
| 页面标题 | Agent Management → Agent 管理 |
| 页面描述 | Create, configure... → 创建、配置... |
| 按钮文本 | Add, Delete, Save, Cancel |
| 表格列头 | Name → 名称, Status → 状态 |
| 表单标签 | Model, Description, System Prompt |
| 弹窗标题 | Create New Agent → 创建新 Agent |
| 状态文本 | Active → 活跃, Loading → 加载中 |
| 空状态 | No agents found → 未找到 Agent |
| 提示信息 | Successfully created → 创建成功 |

## Settings 页面语言切换 UI

```
┌─────────────────────────────────────────┐
│  语言 / Language                        │
│  ─────────────────────────────────────  │
│  选择界面显示语言                         │
│                                         │
│  ┌─────────────┐  ┌─────────────┐      │
│  │  ● 中文     │  │  ○ English  │      │
│  └─────────────┘  └─────────────┘      │
└─────────────────────────────────────────┘
```

- 点击即切换，无需保存按钮
- 切换后界面立即刷新为新语言
- 选中状态用主色高亮显示

## 需要修改的文件

### 新增文件

- `src/i18n/index.ts` - i18next 配置
- `src/i18n/locales/zh.json` - 中文翻译
- `src/i18n/locales/en.json` - 英文翻译

### 修改文件

| 文件 | 修改内容 |
|------|----------|
| `src/main.tsx` | 导入 i18n 初始化 |
| `src/components/common/Sidebar.tsx` | 导航标签翻译 |
| `src/pages/SettingsPage.tsx` | 添加语言切换 UI |
| `src/pages/DashboardPage.tsx` | 页面标题、描述、快捷操作 |
| `src/pages/ChatPage.tsx` | 页面标题、按钮、占位符 |
| `src/pages/AgentsPage.tsx` | 页面标题、表格列头、按钮 |
| `src/pages/SkillsPage.tsx` | 页面标题、表格列头、按钮 |
| `src/pages/MCPPage.tsx` | 页面标题、表格列头、按钮 |
| `src/pages/PluginsPage.tsx` | 页面标题、表格列头、按钮 |
| `src/components/common/AgentFormModal.tsx` | 表单标签、按钮 |
| `src/components/common/ConfirmDialog.tsx` | 确认/取消按钮 |
| `src/components/common/Modal.tsx` | 通用按钮文本 |

## 实施步骤

### Phase 1: 基础设施

1. 安装 i18next 和 react-i18next
2. 创建 `src/i18n/index.ts` 配置文件
3. 创建 `zh.json` 和 `en.json` 翻译文件
4. 在 `main.tsx` 导入 i18n

### Phase 2: 通用组件

5. 翻译 Sidebar 导航标签
6. 翻译 ConfirmDialog、Modal 等通用组件
7. 在 SettingsPage 添加语言切换 UI

### Phase 3: 各页面翻译

8. DashboardPage
9. ChatPage
10. AgentsPage + AgentFormModal
11. SkillsPage
12. MCPPage
13. PluginsPage

### Phase 4: 收尾

14. 检查遗漏的硬编码文本
15. 测试中英文切换
16. 验证 localStorage 持久化

## 预计工作量

- 新增翻译条目：约 150-200 条
- 修改文件：约 15 个
